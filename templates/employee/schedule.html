{% extends 'employee/base_employee.html' %}

{% block title %}Schedule | IntelliHRTrack{% endblock %}

{% block content %}
<!-- Header -->
			<header class="relative overflow-hidden rounded-3xl glass p-6 md:p-8 shadow-glow reveal">
				<div class="absolute inset-0 opacity-40 animate-shine"></div>
				<div class="relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-4">
					<div class="flex items-center gap-4">
						<div class="relative">
							<img class="w-16 h-16 md:w-20 md:h-20 rounded-full object-cover border-4 border-white/50 shadow-lg" src="https://randomuser.me/api/portraits/men/32.jpg" alt="Renzo">
							<div class="absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-2 border-white"></div>
						</div>
						<div>
							<h1 class="text-2xl md:text-3xl font-extrabold tracking-tight">Schedule Portal</h1>
							<p class="text-sm md:text-base text-gray-600 dark:text-gray-300 mt-1">Manage your shifts, swaps, and schedule preferences</p>
							<div class="flex items-center gap-2 mt-2 text-sm">
								<span class="px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full">ID: EMP-8472</span>
								<span class="px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded-full">Sales Department</span>
							</div>
						</div>
					</div>
					<div class="flex items-center gap-3">
						<button id="mobileMenu" class="lg:hidden p-2 rounded-xl glass" aria-label="Open Menu"><iconify-icon icon="ph:list-duotone"></iconify-icon></button>
						<div class="hidden md:flex items-center gap-2 px-3 py-1 rounded-xl glass text-xs">
							<span id="netDot" class="inline-block w-2.5 h-2.5 rounded-full bg-green-500" title="Online"></span>
							<span id="headerClock">--:--:--</span>
						</div>
					</div>
				</div>
			</header>

			<!-- Next Shift Overview -->
			<div class="glass rounded-3xl p-6 shadow-glow reveal">
				<div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
					<div class="flex items-center gap-4">
						<div class="w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white">
							<iconify-icon icon="ph:clock-countdown-duotone" class="text-2xl"></iconify-icon>
						</div>
						<div>
							<h2 class="text-xl font-bold">Next Shift</h2>
							<p class="text-blue-600 dark:text-blue-400">Tomorrow, 9:00 AM - 6:00 PM</p>
							<p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Morning Shift • Sales Department</p>
						</div>
					</div>
					<div class="flex items-center gap-4">
						<div class="text-center">
							<div class="text-2xl font-bold text-blue-600 dark:text-blue-400" id="countdownHours">12</div>
							<div class="text-xs text-gray-500 dark:text-gray-400">Hours</div>
						</div>
						<div class="text-center">
							<div class="text-2xl font-bold text-blue-600 dark:text-blue-400" id="countdownMinutes">45</div>
							<div class="text-xs text-gray-500 dark:text-gray-400">Minutes</div>
						</div>
						<div class="text-center">
							<div class="text-2xl font-bold text-blue-600 dark:text-blue-400" id="countdownSeconds">30</div>
							<div class="text-xs text-gray-500 dark:text-gray-400">Seconds</div>
						</div>
					</div>
				</div>
			</div>

			<div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
				<div class="xl:col-span-2 space-y-6">
					<!-- Schedule Calendar -->
					<div class="glass rounded-3xl p-6 shadow-glow reveal">
						<div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6">
							<h2 class="text-xl font-bold">Schedule Calendar</h2>
							<div class="flex items-center gap-3">
								<div class="flex items-center gap-2">
									<button id="weekView" class="px-4 py-2 rounded-xl glass text-sm bg-accent text-white">Week</button>
									<button id="monthView" class="px-4 py-2 rounded-xl glass text-sm">Month</button>
								</div>
								<div class="flex items-center gap-2">
									<button class="p-2 rounded-lg glass"><iconify-icon icon="ph:caret-left-duotone"></iconify-icon></button>
									<span class="font-medium min-w-32 text-center">Nov 12 - 18, 2023</span>
									<button class="p-2 rounded-lg glass"><iconify-icon icon="ph:caret-right-duotone"></iconify-icon></button>
								</div>
							</div>
						</div>

						<div id="weekCalendar" class="space-y-4">
							<div class="grid grid-cols-8 gap-2 text-sm">
								<div class="p-3 text-center font-medium">Time</div>
								<div class="p-3 text-center font-medium bg-blue-50 dark:bg-blue-900/30 rounded-lg">Mon 12</div>
								<div class="p-3 text-center font-medium bg-blue-50 dark:bg-blue-900/30 rounded-lg">Tue 13</div>
								<div class="p-3 text-center font-medium bg-blue-50 dark:bg-blue-900/30 rounded-lg">Wed 14</div>
								<div class="p-3 text-center font-medium bg-blue-50 dark:bg-blue-900/30 rounded-lg">Thu 15</div>
								<div class="p-3 text-center font-medium bg-blue-50 dark:bg-blue-900/30 rounded-lg">Fri 16</div>
								<div class="p-3 text-center font-medium bg-green-50 dark:bg-green-900/30 rounded-lg">Sat 17</div>
								<div class="p-3 text-center font-medium bg-yellow-50 dark:bg-yellow-900/30 rounded-lg">Sun 18</div>
							</div>

							<div class="grid grid-cols-8 gap-2">
								<div class="p-2 text-xs text-gray-500 text-center">8:00 AM</div>
								<div class="p-2"></div>
								<div class="p-2 shift-morning rounded-lg cursor-pointer hover-lift" data-shift="morning">
									<p class="text-xs font-medium">Morning Shift</p>
									<p class="text-xs">9:00 AM - 5:00 PM</p>
								</div>
								<div class="p-2"></div>
								<div class="p-2 shift-morning rounded-lg cursor-pointer hover-lift" data-shift="morning">
									<p class="text-xs font-medium">Morning Shift</p>
									<p class="text-xs">9:00 AM - 5:00 PM</p>
								</div>
								<div class="p-2"></div>
								<div class="p-2 rest-day rounded-lg">
									<p class="text-xs font-medium">Rest Day</p>
								</div>
								<div class="p-2 holiday rounded-lg">
									<p class="text-xs font-medium">Holiday</p>
									<p class="text-xs">Thanksgiving</p>
								</div>
							</div>

							<div class="grid grid-cols-8 gap-2">
								<div class="p-2 text-xs text-gray-500 text-center">12:00 PM</div>
								<div class="p-2"></div>
								<div class="p-2"></div>
								<div class="p-2 shift-afternoon rounded-lg cursor-pointer hover-lift" data-shift="afternoon">
									<p class="text-xs font-medium">Afternoon Shift</p>
									<p class="text-xs">1:00 PM - 9:00 PM</p>
								</div>
								<div class="p-2"></div>
								<div class="p-2"></div>
								<div class="p-2"></div>
								<div class="p-2"></div>
							</div>

							<div class="grid grid-cols-8 gap-2">
								<div class="p-2 text-xs text-gray-500 text-center">4:00 PM</div>
								<div class="p-2"></div>
								<div class="p-2"></div>
								<div class="p-2"></div>
								<div class="p-2 shift-night rounded-lg cursor-pointer hover-lift" data-shift="night">
									<p class="text-xs font-medium">Night Shift</p>
									<p class="text-xs">6:00 PM - 2:00 AM</p>
								</div>
								<div class="p-2 shift-overtime rounded-lg cursor-pointer hover-lift" data-shift="overtime">
									<p class="text-xs font-medium">Overtime</p>
									<p class="text-xs">6:00 PM - 9:00 PM</p>
								</div>
								<div class="p-2"></div>
								<div class="p-2"></div>
							</div>
						</div>

						<!-- Filters -->
						<div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
							<h3 class="text-sm font-medium mb-3">Filter Shifts</h3>
							<div class="flex flex-wrap gap-2">
								<button class="px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full text-xs flex items-center gap-1"><div class="w-2 h-2 bg-blue-500 rounded-full"></div> Morning</button>
								<button class="px-3 py-1 bg-amber-100 dark:bg-amber-900 text-amber-800 dark:text-amber-200 rounded-full text-xs flex items-center gap-1"><div class="w-2 h-2 bg-amber-500 rounded-full"></div> Afternoon</button>
								<button class="px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded-full text-xs flex items-center gap-1"><div class="w-2 h-2 bg-purple-500 rounded-full"></div> Night</button>
								<button class="px-3 py-1 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 rounded-full text-xs flex items-center gap-1"><div class="w-2 h-2 bg-red-500 rounded-full"></div> Overtime</button>
								<button class="px-3 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-full text-xs flex items-center gap-1"><div class="w-2 h-2 bg-green-500 rounded-full"></div> Rest Days</button>
								<button class="px-3 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded-full text-xs flex items-center gap-1"><div class="w-2 h-2 bg-yellow-500 rounded-full"></div> Holidays</button>
							</div>
						</div>
					</div>

					<!-- Shift History -->
					<div class="glass rounded-3xl p-6 shadow-glow reveal">
						<div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6">
							<h2 class="text-xl font-bold">Shift History</h2>
							<div class="flex items-center gap-3">
								<select class="px-4 py-2 rounded-xl glass text-sm"><option>Last 30 Days</option><option>This Month</option><option>Last Month</option></select>
							</div>
						</div>
						<div class="overflow-x-auto">
							<table class="w-full text-sm">
								<thead>
									<tr class="border-b border-gray-200 dark:border-gray-700"><th class="text-left p-3">Date</th><th class="text-left p-3">Shift Type</th><th class="text-left p-3">Start Time</th><th class="text-left p-3">End Time</th><th class="text-left p-3">Total Hours</th><th class="text-left p-3">Status</th></tr>
								</thead>
								<tbody>
									<tr class="border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><td class="p-3">Nov 15, 2023</td><td class="p-3"><span class="px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs rounded-full">Morning</span></td><td class="p-3">9:00 AM</td><td class="p-3">5:00 PM</td><td class="p-3">8.0 hours</td><td class="p-3"><span class="px-2 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 text-xs rounded-full">Completed</span></td></tr>
									<tr class="border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><td class="p-3">Nov 14, 2023</td><td class="p-3"><span class="px-2 py-1 bg-amber-100 dark:bg-amber-900 text-amber-800 dark:text-amber-200 text-xs rounded-full">Afternoon</span></td><td class="p-3">1:00 PM</td><td class="p-3">9:00 PM</td><td class="p-3">8.0 hours</td><td class="p-3"><span class="px-2 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 text-xs rounded-full">Completed</span></td></tr>
									<tr class="border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><td class="p-3">Nov 13, 2023</td><td class="p-3"><span class="px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 text-xs rounded-full">Night</span></td><td class="p-3">6:00 PM</td><td class="p-3">2:00 AM</td><td class="p-3">8.0 hours</td><td class="p-3"><span class="px-2 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 text-xs rounded-full">Completed</span></td></tr>
									<tr class="border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"><td class="p-3">Nov 12, 2023</td><td class="p-3"><span class="px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs rounded-full">Morning</span></td><td class="p-3">9:00 AM</td><td class="p-3">5:00 PM</td><td class="p-3">8.0 hours</td><td class="p-3"><span class="px-2 py-1 bg-amber-100 dark:bg-amber-900 text-amber-800 dark:text-amber-200 text-xs rounded-full">Late</span></td></tr>
								</tbody>
							</table>
						</div>
					</div>

					<!-- Overtime Tracker -->
					<div class="glass rounded-3xl p-6 shadow-glow reveal">
						<h2 class="text-xl font-bold mb-4">Scheduled Overtime</h2>
						<div class="space-y-4">
							<div class="p-4 shift-overtime rounded-xl"><div class="flex justify-between items-start"><div><p class="font-medium">Friday, November 17</p><p class="text-sm text-gray-600 dark:text-gray-400 mt-1">6:00 PM - 9:00 PM (3 hours)</p><p class="text-xs text-gray-500 dark:text-gray-500 mt-2">Project deadline completion</p></div><span class="px-2 py-1 bg-amber-100 dark:bg-amber-900 text-amber-800 dark:text-amber-200 text-xs rounded-full">Pending Approval</span></div></div>
							<div class="p-4 shift-overtime rounded-xl"><div class="flex justify-between items-start"><div><p class="font-medium">Saturday, November 25</p><p class="text-sm text-gray-600 dark:text-gray-400 mt-1">10:00 AM - 2:00 PM (4 hours)</p><p class="text-xs text-gray-500 dark:text-gray-500 mt-2">Inventory count</p></div><span class="px-2 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 text-xs rounded-full">Approved</span></div></div>
						</div>
					</div>
				</div>

				<div class="space-y-6">
					<!-- Overview Stats -->
					<div class="glass rounded-3xl p-6 shadow-glow reveal">
						<h2 class="text-xl font-bold mb-4">Schedule Overview</h2>
						<div class="grid grid-cols-2 gap-4">
							<div class="p-4 bg-blue-50 dark:bg-blue-900/30 rounded-xl text-center"><div class="w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center mx-auto mb-2"><iconify-icon icon="ph:calendar-duotone" class="text-white"></iconify-icon></div><p class="text-sm text-gray-600 dark:text-gray-400">Total Shifts</p><p class="text-2xl font-bold mt-1">18</p><p class="text-xs text-blue-500 mt-1">This month</p></div>
							<div class="p-4 bg-red-50 dark:bg-red-900/30 rounded-xl text-center"><div class="w-10 h-10 rounded-full bg-red-500 flex items-center justify-center mx-auto mb-2"><iconify-icon icon="ph:clock-countdown-duotone" class="text-white"></iconify-icon></div><p class="text-sm text-gray-600 dark:text-gray-400">Overtime Shifts</p><p class="text-2xl font-bold mt-1">3</p><p class="text-xs text-red-500 mt-1">12.5 hours</p></div>
							<div class="p-4 bg-green-50 dark:bg-green-900/30 rounded-xl text-center"><div class="w-10 h-10 rounded-full bg-green-500 flex items-center justify-center mx-auto mb-2"><iconify-icon icon="ph:bed-duotone" class="text-white"></iconify-icon></div><p class="text-sm text-gray-600 dark:text-gray-400">Rest Days</p><p class="text-2xl font-bold mt-1">8</p><p class="text-xs text-green-500 mt-1">This month</p></div>
							<div class="p-4 bg-amber-50 dark:bg-amber-900/30 rounded-xl text-center"><div class="w-10 h-10 rounded-full bg-amber-500 flex items-center justify-center mx-auto mb-2"><iconify-icon icon="ph:trend-up-duotone" class="text-white"></iconify-icon></div><p class="text-sm text-gray-600 dark:text-gray-400">Attendance Rate</p><p class="text-2xl font-bold mt-1">94%</p><p class="text-xs text-amber-500 mt-1">+5% from last month</p></div>
						</div>
					</div>

					<!-- AI Insights -->
					<div class="glass rounded-3xl p-6 shadow-glow reveal">
						<h2 class="text-xl font-bold mb-4">AI Schedule Insights</h2>
						<div class="space-y-4">
							<div class="p-4 bg-gradient-to-br from-green-50 to-emerald-100 dark:from-green-900/30 dark:to-emerald-900/20 rounded-xl border border-green-200 dark:border-green-700"><div class="flex items-start gap-3"><iconify-icon icon="ph:trend-up-duotone" class="text-green-500 mt-1"></iconify-icon><div><p class="font-medium text-green-800 dark:text-green-300">You've had 95% shift attendance accuracy this month.</p><p class="text-sm text-green-600 dark:text-green-400 mt-1">Excellent consistency!</p></div></div></div>
							<div class="p-4 bg-gradient-to-br from-amber-50 to-yellow-100 dark:from-amber-900/30 dark:to-yellow-900/20 rounded-xl border border-amber-200 dark:border-amber-700"><div class="flex items-start gap-3"><iconify-icon icon="ph:warning-duotone" class="text-amber-500 mt-1"></iconify-icon><div><p class="font-medium text-amber-800 dark:text-amber-300">You missed 2 night shifts last week.</p><p class="text-sm text-amber-600 dark:text-amber-400 mt-1">Consider adjusting your sleep schedule.</p></div></div></div>
							<div class="p-4 bg-gradient-to-br from-blue-50 to-cyan-100 dark:from-blue-900/30 dark:to-cyan-900/20 rounded-xl border border-blue-200 dark:border-blue-700"><div class="flex items-start gap-3"><iconify-icon icon="ph:clock-countdown-duotone" class="text-blue-500 mt-1"></iconify-icon><div><p class="font-medium text-blue-800 dark:text-blue-300">Your overtime hours increased by 25% this month.</p><p class="text-sm text-blue-600 dark:text-blue-400 mt-1">Remember to maintain work-life balance.</p></div></div></div>
						</div>
					</div>

					<!-- Alerts & Swap Requests compacted into right column area for balance -->
				</div>
			</div>

			<!-- Swap & Rest Day Forms -->
			<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
				<div class="glass rounded-3xl p-6 shadow-glow reveal">
					<h2 class="text-xl font-bold mb-4">Request Shift Swap</h2>
					<div class="space-y-4">
						<div><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Select Shift to Swap</label><select class="w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 glass py-2 px-3"><option>November 20, 2023 - Morning Shift (9:00 AM - 5:00 PM)</option></select></div>
						<div><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Swap With Colleague</label><select class="w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 glass py-2 px-3"><option>Sarah Johnson (Sales Dept)</option></select></div>
						<div><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Reason for Swap</label><textarea class="w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 glass py-2 px-3" rows="3" placeholder="Explain why you need to swap this shift..."></textarea></div>
						<button class="w-full px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-xl font-medium transition-all ripple">Submit Swap Request</button>
					</div>
				</div>

				<div class="glass rounded-3xl p-6 shadow-glow reveal">
					<h2 class="text-xl font-bold mb-4">Request Rest Day Adjustment</h2>
					<div class="space-y-4">
						<div><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Current Rest Day</label><input type="text" class="w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 glass py-2 px-3" value="Sunday, November 19" readonly></div>
						<div><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Requested Rest Day</label><select class="w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 glass py-2 px-3"><option>Monday, November 20</option></select></div>
						<div><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Reason for Adjustment</label><textarea class="w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 glass py-2 px-3" rows="3" placeholder="Explain why you need this rest day adjustment..."></textarea></div>
						<button class="w-full px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-xl font-medium transition-all ripple">Submit Adjustment Request</button>
					</div>
				</div>
			</div>

			<!-- Export -->
			<div class="glass rounded-3xl p-6 shadow-glow reveal">
				<h2 class="text-xl font-bold mb-4">Export Schedule</h2>
				<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
					<div class="p-6 bg-gradient-to-br from-blue-50 to-cyan-100 dark:from-blue-900/30 dark:to-cyan-900/20 rounded-2xl border border-blue-200 dark:border-blue-700 text-center">
						<iconify-icon icon="ph:file-pdf-duotone" class="text-red-500 text-4xl mb-4"></iconify-icon>
						<h3 class="font-bold text-blue-800 dark:text-blue-300 mb-2">PDF Export</h3>
						<p class="text-sm text-blue-600 dark:text-blue-400 mb-4">Professional format for printing</p>
						<button class="w-full px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-xl text-sm transition-all ripple">Export as PDF</button>
					</div>
					<div class="p-6 bg-gradient-to-br from-green-50 to-emerald-100 dark:from-green-900/30 dark:to-emerald-900/20 rounded-2xl border border-green-200 dark:border-green-700 text-center">
						<iconify-icon icon="ph:file-csv-duotone" class="text-green-500 text-4xl mb-4"></iconify-icon>
						<h3 class="font-bold text-green-800 dark:text-green-300 mb-2">CSV Export</h3>
						<p class="text-sm text-green-600 dark:text-green-400 mb-4">Spreadsheet format for analysis</p>
						<button class="w-full px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-xl text-sm transition-all ripple">Export as CSV</button>
					</div>
					<div class="p-6 bg-gradient-to-br from-amber-50 to-yellow-100 dark:from-amber-900/30 dark:to-yellow-900/20 rounded-2xl border border-amber-200 dark:border-amber-700 text-center">
						<iconify-icon icon="ph:printer-duotone" class="text-amber-500 text-4xl mb-4"></iconify-icon>
						<h3 class="font-bold text-amber-800 dark:text-amber-300 mb-2">Direct Print</h3>
						<p class="text-sm text-amber-600 dark:text-amber-400 mb-4">Print schedule directly</p>
						<button class="w-full px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-xl text-sm transition-all ripple">Print Schedule</button>
					</div>
				</div>
			</div>

			<footer class="pb-8 pt-2 text-xs text-gray-500 dark:text-gray-400 text-center">© IntelliHRTrack • User Schedule Portal</footer>
{% endblock %}

{% block extra_js %}
<script>
		// Active link highlighter (filename based)
		(function(){const file=location.pathname.split('/').pop();document.querySelectorAll('aside nav a').forEach(a=>{const href=a.getAttribute('href');if(!href) return; if(href===file){a.classList.add('gradient-accent','text-white','shadow-glow');a.classList.remove('glass');} else {a.classList.remove('gradient-accent','text-white');if(!a.classList.contains('glass')) a.classList.add('glass');}});})();
		// Theme toggle hookup
		(function(){function save(){localStorage.setItem('ih_theme',document.documentElement.classList.contains('dark')?'dark':'light');}['themeToggle','themeToggleHeader'].forEach(id=>{const el=document.getElementById(id);if(el){el.addEventListener('click',()=>{document.documentElement.classList.toggle('dark');save();});}});})();
		</script>

<script>
		// Theme & prefs
		const themeToggle = document.getElementById('themeToggle');
		function toggleTheme(){ document.documentElement.classList.toggle('dark'); localStorage.setItem('ih_theme', document.documentElement.classList.contains('dark')?'dark':'light'); }
		themeToggle?.addEventListener('click', toggleTheme);
		if(localStorage.getItem('ih_theme')==='dark') document.documentElement.classList.add('dark');

		// Clock + network
		const headerClock = document.getElementById('headerClock'); const netDot = document.getElementById('netDot');
		function updateClock(){ if(headerClock) headerClock.textContent = new Date().toLocaleTimeString(); }
		setInterval(updateClock,1000); updateClock();
		function updateNet(){ const on = navigator.onLine; if(netDot){ netDot.classList.toggle('bg-green-500', on); netDot.classList.toggle('bg-rose-500', !on); netDot.title = on?'Online':'Offline'; } }
		window.addEventListener('online', updateNet); window.addEventListener('offline', updateNet); updateNet();

		// Settings modal
		const customizeBtn = document.getElementById('customizeLayout'); const settingsPanel = document.getElementById('settingsPanel'); const closeSettings = document.getElementById('closeSettings');
		customizeBtn?.addEventListener('click', ()=>{ settingsPanel.classList.remove('hidden'); settingsPanel.classList.add('flex'); }); closeSettings?.addEventListener('click', ()=>{ settingsPanel.classList.add('hidden'); settingsPanel.classList.remove('flex'); });
		document.getElementById('saveSettings')?.addEventListener('click', ()=>{ settingsPanel.classList.add('hidden'); settingsPanel.classList.remove('flex'); showToast('Preferences saved','success'); });

		// Shortcuts
		const shortcutsModal = document.getElementById('shortcutsModal'); const shortcutsBtn = document.getElementById('shortcutsBtn'); const closeShortcuts = document.getElementById('closeShortcuts');
		shortcutsBtn?.addEventListener('click', ()=>{ shortcutsModal.classList.remove('hidden'); shortcutsModal.classList.add('flex'); }); closeShortcuts?.addEventListener('click', ()=>{ shortcutsModal.classList.add('hidden'); shortcutsModal.classList.remove('flex'); });
		document.addEventListener('keydown', (e)=>{ if(e.key.toLowerCase()==='s'){ e.preventDefault(); customizeBtn?.click(); } if(e.key.toLowerCase()==='t'){ e.preventDefault(); toggleTheme(); } if(e.key==='?'){ e.preventDefault(); shortcutsBtn?.click(); } });

		// Mobile sidebar
		const mobileMenuBtn = document.getElementById('mobileMenu'); const mobileSidebar = document.getElementById('mobileSidebar'); const mobilePanel = document.getElementById('mobilePanel'); const mobileBackdrop = document.getElementById('mobileBackdrop'); const mobileClose = document.getElementById('closeMobile'); const mobileNavContent = document.getElementById('mobileNavContent');
		function openMobile(){ const desk = document.querySelector('aside nav ul'); if(desk && mobileNavContent){ mobileNavContent.innerHTML=''; mobileNavContent.appendChild(desk.cloneNode(true)); mobileNavContent.querySelectorAll('a').forEach(a=> a.addEventListener('click', ()=> closeMobile())); }
			mobileSidebar.classList.remove('hidden'); requestAnimationFrame(()=> mobilePanel.classList.remove('-translate-x-full'));
		}
		function closeMobile(){ mobilePanel.classList.add('-translate-x-full'); setTimeout(()=> mobileSidebar.classList.add('hidden'),250); }
		mobileMenuBtn?.addEventListener('click', openMobile); mobileBackdrop?.addEventListener('click', closeMobile); mobileClose?.addEventListener('click', closeMobile);

		// Reveal & micro-interactions
		Array.from(document.querySelectorAll('.glass')).forEach(el=> el.classList.add('hover-lift'));
		Array.from(document.querySelectorAll('button')).forEach(el=> el.classList.add('ripple'));
		const revealables = Array.from(document.querySelectorAll('.reveal'));
		const io = new IntersectionObserver(entries=>{ entries.forEach(en=>{ if(en.isIntersecting){ en.target.classList.add('in-view'); io.unobserve(en.target); } }); }, { threshold: 0.12 });
		revealables.forEach(el=> io.observe(el));

		// Toasts
		const toastHost = document.getElementById('toastHost'); function showToast(msg, type='info'){ if(!toastHost) return; const it = document.createElement('div'); it.className = `toast ${type} glass`; it.style.minWidth='220px'; it.style.padding='10px 12px'; it.style.borderRadius='12px'; it.innerHTML = `<div class="flex items-start gap-2"><iconify-icon icon="ph:info-duotone" class="text-accent mt-1"></iconify-icon><div class="text-sm">${msg}</div></div>`; toastHost.appendChild(it); setTimeout(()=>{ it.style.transition='opacity .4s, transform .4s'; it.style.opacity='0'; it.style.transform='translateY(-6px)'; },2600); setTimeout(()=> it.remove(),3100); }
		setTimeout(()=> showToast('Schedule loaded — ready.','success'),700);

		// Countdown
		function updateCountdown(){ const nextShift = new Date(); nextShift.setDate(nextShift.getDate()+1); nextShift.setHours(9,0,0,0); const now=new Date(); const diffMs = nextShift - now; const hours=Math.floor(diffMs/(1000*60*60)); const minutes=Math.floor((diffMs%(1000*60*60))/(1000*60)); const seconds=Math.floor((diffMs%(1000*60))/1000); document.getElementById('countdownHours').textContent = String(hours).padStart(2,'0'); document.getElementById('countdownMinutes').textContent = String(minutes).padStart(2,'0'); document.getElementById('countdownSeconds').textContent = String(seconds).padStart(2,'0'); }
		setInterval(()=>{ updateCountdown(); updateClock(); },1000); updateCountdown();

		// Modal wiring
		const shiftModal = document.getElementById('shiftModal'); const closeModal = document.getElementById('closeModal'); const closeModalSecondary = document.getElementById('closeModalSecondary');
		document.querySelectorAll('[data-shift]').forEach(shift=> shift.addEventListener('click', ()=> shiftModal.classList.remove('hidden')));
		closeModal?.addEventListener('click', ()=> shiftModal.classList.add('hidden'));
		closeModalSecondary?.addEventListener('click', ()=> shiftModal.classList.add('hidden'));
		shiftModal?.addEventListener('click', (e)=>{ if(e.target===shiftModal) shiftModal.classList.add('hidden'); });

		// Conflict detector (simulated)
		function detectConflicts(){ const hasConflict = Math.random() > 0.7; if(hasConflict){ const conflictDay = document.querySelector('.shift-overtime'); if(conflictDay){ const warningIcon = document.createElement('iconify-icon'); warningIcon.setAttribute('icon','ph:warning-duotone'); warningIcon.className='text-red-500 absolute top-1 right-1'; conflictDay.style.position='relative'; conflictDay.appendChild(warningIcon); } } }
		detectConflicts();

		// Attach week/month toggle visuals
		const weekViewBtn = document.getElementById('weekView'); const monthViewBtn = document.getElementById('monthView');
		weekViewBtn?.addEventListener('click', function(){ this.classList.add('bg-accent','text-white'); monthViewBtn?.classList.remove('bg-accent','text-white'); });
		monthViewBtn?.addEventListener('click', function(){ this.classList.add('bg-accent','text-white'); weekViewBtn?.classList.remove('bg-accent','text-white'); });

	</script>
{% endblock %}
